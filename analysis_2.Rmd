---
title: "analysis_2"
author: "Eden Deng, Jane Zhang, Shari Tian"
date: "11/6/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

```{r load_data, warning = FALSE}
library(tidyverse)
library(dplyr)
library(ggplot2)
library(foreign)
library(naniar)
library(mlmi)
library(glmnet)

taiwan_orig <- read.csv("probit_taiwan_data.csv")
taiwan_orig <- taiwan_orig %>%
  select(-X)
```

```{r impute}
miss_var_summary(taiwan_orig)

pct_miss(taiwan_orig)

vis_miss(taiwan_orig)

mcar_test(taiwan_orig)

#taiwan_impute <- catImp(taiwan_orig, M=1, pd=TRUE, steps = 500, type=3, rseed=4423)
#names(taiwan_impute) <- names(taiwan_orig)

# rename and factor variables
#taiwan <- data.frame("Gender" = factor(taiwan_impute$se002, ordered = TRUE), "Age" = factor(taiwan_impute$se003, ordered = TRUE), "Education" = factor(taiwan_impute$se005, ordered = TRUE), "Income" = factor(taiwan_impute$se009, ordered = TRUE), "PolInterest" = factor(taiwan_impute$q056, ordered = TRUE), "DemSat" = factor(taiwan_impute$q098, ordered = TRUE), "Vote" = factor(taiwan_impute$q027, ordered = TRUE), "UnderstandPol" = factor(taiwan_impute$q127, ordered = TRUE), "TrustGov" = factor(taiwan_impute$q131, ordered = TRUE))

#write.table(taiwan, "probit_taiwan_imputed.dat")

taiwan <- read.table("probit_taiwan_imputed.dat")
```

```{r}
model <- glm(Vote ~ ., family = binomial(link = "probit"), 
    data = taiwan)

summary(model)
```

```{r}
levels(taiwan$Vote)
```




